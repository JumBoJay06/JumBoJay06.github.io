<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"jumbojay06.github.io","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

<script type="module">
  // Import the functions you need from the SDKs you need
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-analytics.js";
  // TODO: Add SDKs for Firebase products that you want to use
  // https://firebase.google.com/docs/web/setup#available-libraries

  // Your web app's Firebase configuration
  // For Firebase JS SDK v7.20.0 and later, measurementId is optional
  const firebaseConfig = {
    apiKey: "AIzaSyDkuH0gFzHYIQBq0qewWSLvEiofDF5StcM",
    authDomain: "myblog-73629.firebaseapp.com",
    projectId: "myblog-73629",
    storageBucket: "myblog-73629.firebasestorage.app",
    messagingSenderId: "496090564418",
    appId: "1:496090564418:web:c97828463c3d7cb8fdeadb",
    measurementId: "G-CFZ2K6D04Y"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const analytics = getAnalytics(app);
</script>

  <meta name="description" content="MySQL（SQL資料庫）CRUD 與 API驗證之實作這次我們就不用 Youbike 做延伸，而是建立一個間單的會員模組吧！">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL（SQL資料庫）CRUD 與 API驗證之實作">
<meta property="og:url" content="https://jumbojay06.github.io/2025/07/03/MySQL%EF%BC%88SQL%E8%B3%87%E6%96%99%E5%BA%AB%EF%BC%89CRUD-%E8%88%87-API%E9%A9%97%E8%AD%89%E4%B9%8B%E5%AF%A6%E4%BD%9C/">
<meta property="og:site_name" content="JumBoJay 小小筆記">
<meta property="og:description" content="MySQL（SQL資料庫）CRUD 與 API驗證之實作這次我們就不用 Youbike 做延伸，而是建立一個間單的會員模組吧！">
<meta property="og:locale" content="zh_TW">
<meta property="article:published_time" content="2025-07-03T09:36:32.000Z">
<meta property="article:modified_time" content="2025-07-15T08:57:14.411Z">
<meta property="article:author" content="JumBoJay">
<meta property="article:tag" content="Quarkus">
<meta property="article:tag" content="MySQL">
<meta property="article:tag" content="JWT">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://jumbojay06.github.io/2025/07/03/MySQL%EF%BC%88SQL%E8%B3%87%E6%96%99%E5%BA%AB%EF%BC%89CRUD-%E8%88%87-API%E9%A9%97%E8%AD%89%E4%B9%8B%E5%AF%A6%E4%BD%9C/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-TW'
  };
</script>

  <title>MySQL（SQL資料庫）CRUD 與 API驗證之實作 | JumBoJay 小小筆記 - 主要以學習筆記與生活分享為主</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-TZMDCG8Q6J"></script>
    <script>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-TZMDCG8Q6J');
      }
    </script>






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切換導航欄">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">JumBoJay 小小筆記</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">主要以學習筆記與生活分享為主</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首頁</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>關於</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>標籤</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分類</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="reading-progress-bar"></div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://jumbojay06.github.io/2025/07/03/MySQL%EF%BC%88SQL%E8%B3%87%E6%96%99%E5%BA%AB%EF%BC%89CRUD-%E8%88%87-API%E9%A9%97%E8%AD%89%E4%B9%8B%E5%AF%A6%E4%BD%9C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="JumBoJay">
      <meta itemprop="description" content="程式與攝影的交集">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="JumBoJay 小小筆記">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          MySQL（SQL資料庫）CRUD 與 API驗證之實作
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2025-07-03 17:36:32" itemprop="dateCreated datePublished" datetime="2025-07-03T17:36:32+08:00">2025-07-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2025-07-15 16:57:14" itemprop="dateModified" datetime="2025-07-15T16:57:14+08:00">2025-07-15</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%A8%8B%E5%BC%8F%E8%AA%9E%E8%A8%80/" itemprop="url" rel="index"><span itemprop="name">程式語言</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%A8%8B%E5%BC%8F%E8%AA%9E%E8%A8%80/%E5%BE%8C%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">後端</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%A8%8B%E5%BC%8F%E8%AA%9E%E8%A8%80/%E5%BE%8C%E7%AB%AF/Quarkus/" itemprop="url" rel="index"><span itemprop="name">Quarkus</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%A8%8B%E5%BC%8F%E8%AA%9E%E8%A8%80/%E5%BE%8C%E7%AB%AF/Quarkus/MySQL/" itemprop="url" rel="index"><span itemprop="name">MySQL</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%A8%8B%E5%BC%8F%E8%AA%9E%E8%A8%80/%E5%BE%8C%E7%AB%AF/Quarkus/JWT/" itemprop="url" rel="index"><span itemprop="name">JWT</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2025/07/03/MySQL%EF%BC%88SQL%E8%B3%87%E6%96%99%E5%BA%AB%EF%BC%89CRUD-%E8%88%87-API%E9%A9%97%E8%AD%89%E4%B9%8B%E5%AF%A6%E4%BD%9C/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2025/07/03/MySQL（SQL資料庫）CRUD-與-API驗證之實作/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="MySQL（SQL資料庫）CRUD-與-API驗證之實作"><a href="#MySQL（SQL資料庫）CRUD-與-API驗證之實作" class="headerlink" title="MySQL（SQL資料庫）CRUD 與 API驗證之實作"></a>MySQL（SQL資料庫）CRUD 與 API驗證之實作</h1><p>這次我們就不用 Youbike 做延伸，而是建立一個間單的會員模組吧！</p>
<span id="more"></span>
<h2 id="設定檔"><a href="#設定檔" class="headerlink" title="設定檔"></a>設定檔</h2><p>新增 MySQL、JWT、OpenAPI 等等設定</p>
<h3 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a>MySQL</h3><p>主要是一些 ORM 跟 jdbc 的設定</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">hibernate-orm:</span></span><br><span class="line">  <span class="comment"># 當設定為 drop-and-create 時，每次 Quarkus 啟動都會清除並重建資料庫結構。</span></span><br><span class="line">  <span class="comment"># 這在開發初期非常方便，但在生產環境中應改為 &#x27;validate&#x27; 或 &#x27;update&#x27;。</span></span><br><span class="line"><span class="attr">database:</span></span><br><span class="line">  <span class="attr">generation:</span> <span class="string">drop-and-create</span></span><br><span class="line">  <span class="comment"># 在主控台顯示執行的 SQL 語句，方便開發時除錯</span></span><br><span class="line">  <span class="attr">log:</span></span><br><span class="line">    <span class="attr">sql:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">datasource:</span></span><br><span class="line">  <span class="attr">db-kind:</span> <span class="string">mysql</span></span><br><span class="line">  <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">  <span class="attr">password:</span> <span class="string">jay12345</span></span><br><span class="line">  <span class="attr">jdbc:</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://localhost:9527/user_db?createDatabaseIfNotExist=true</span></span><br></pre></td></tr></table></figure>
<h2 id="OpenAPI"><a href="#OpenAPI" class="headerlink" title="OpenAPI"></a>OpenAPI</h2><p>只需要設定 OpenAPI json 跟 swagger-ui 的位置就好，套件會自己爬全部的 API 出來</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># OpenAPI / Swagger UI 設定</span></span><br><span class="line"><span class="attr">smallrye-openapi:</span></span><br><span class="line">  <span class="attr">path:</span> <span class="string">/openapi</span></span><br><span class="line"><span class="attr">swagger-ui:</span></span><br><span class="line">  <span class="attr">path:</span> <span class="string">/q/swagger-ui</span></span><br><span class="line">  <span class="attr">always-include:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<h2 id="JWT"><a href="#JWT" class="headerlink" title="JWT"></a>JWT</h2><p>JWT 是一種輕量、無狀態的身份驗證方式，特別適合用於 RESTful API</p>
<h3 id="公私鑰"><a href="#公私鑰" class="headerlink" title="公私鑰"></a>公私鑰</h3><p>在寫設定檔之前需要先把公私鑰產出來，這邊就先簡單範例，一般會把這類的東西藏起來<br>產生 JWT 簽章所需的金鑰</p>
<ol>
<li>開啟終端機或 Git Bash。</li>
<li>建立一個暫存資料夾，例如 <code>mkdir keys &amp;&amp; cd keys</code>。</li>
<li>執行以下指令產生 2048 位元的 RSA 私鑰：<code>openssl genrsa -out privateKey.pem 2048</code></li>
<li>從私鑰中提取公鑰：<code>openssl rsa -in privateKey.pem -pubout -out publicKey.pem</code></li>
<li>將產生的 <code>privateKey.pem</code> 和 <code>publicKey.pem</code> 檔案複製到您 Quarkus 專案的 <code>src/main/resources/META-INF/resources/</code> 目錄下。(資料夾位置沒有一定)</li>
</ol>
<h3 id="設定黨"><a href="#設定黨" class="headerlink" title="設定黨"></a>設定黨</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">mp:</span></span><br><span class="line">  <span class="attr">jwt:</span></span><br><span class="line">    <span class="attr">verify:</span></span><br><span class="line">      <span class="comment"># 簽發 JWT 的單位名稱，登入 API 產生的 token 中 &#x27;iss&#x27; 欄位會是這個值</span></span><br><span class="line">      <span class="attr">issuer:</span> <span class="string">https://myapp.com/issuer</span></span><br><span class="line">      <span class="comment"># 用於驗證 JWT 簽章的公鑰位置。Quarkus 會從 classpath 中尋找這個檔案。</span></span><br><span class="line">      <span class="attr">publickey:</span></span><br><span class="line">        <span class="attr">location:</span> <span class="string">META-INF/resources/publicKey.pem</span></span><br><span class="line"><span class="comment"># --- SmallRye JWT Configuration ---</span></span><br><span class="line"><span class="attr">smallrye:</span></span><br><span class="line">  <span class="attr">jwt:</span></span><br><span class="line">    <span class="attr">sign:</span></span><br><span class="line">      <span class="attr">key:</span></span><br><span class="line">        <span class="attr">location:</span> <span class="string">META-INF/resources/privateKey.pem</span></span><br><span class="line"><span class="comment"># 自訂的 JWT 產生設定</span></span><br><span class="line"><span class="attr">app:</span></span><br><span class="line">  <span class="attr">jwt:</span></span><br><span class="line">    <span class="attr">duration-in-seconds:</span> <span class="number">3600</span> <span class="comment"># Token 有效期 (秒)</span></span><br></pre></td></tr></table></figure>
<details>

<summary>完整檔案</summary>

<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Quarkus 框架的主要設定</span></span><br><span class="line"><span class="attr">quarkus:</span></span><br><span class="line">  <span class="comment"># HTTP 伺服器相關設定</span></span><br><span class="line">  <span class="attr">http:</span></span><br><span class="line">    <span class="comment"># 設定應用程式監聽的 HTTP 連接埠</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">8080</span></span><br><span class="line">  <span class="attr">rest:</span></span><br><span class="line">    <span class="attr">auth:</span></span><br><span class="line">      <span class="attr">challenge-on-auth-failure:</span> <span class="literal">false</span></span><br><span class="line">  <span class="comment"># 應用程式基本資訊設定</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="comment"># 應用程式名稱</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">youbike-api-java</span></span><br><span class="line">    <span class="comment"># 應用程式版本</span></span><br><span class="line">    <span class="attr">version:</span> <span class="number">1.0</span><span class="number">.0</span></span><br><span class="line">  <span class="comment"># REST 客戶端設定</span></span><br><span class="line">  <span class="attr">rest-client:</span></span><br><span class="line">    <span class="comment"># &#x27;you-bike-api&#x27; 是客戶端介面的設定 ID (對應 @RegisterRestClient 的 configKey)</span></span><br><span class="line">    <span class="attr">you-bike-api:</span></span><br><span class="line">      <span class="comment"># API 的目標 URL</span></span><br><span class="line">      <span class="attr">url:</span> <span class="string">&quot;https://tcgbusfs.blob.core.windows.net/dotapp/youbike/v2/youbike_immediate.json&quot;</span></span><br><span class="line">      <span class="comment"># 設定此 REST 客戶端的 CDI Bean 範圍為 Singleton (單例)</span></span><br><span class="line">      <span class="attr">scope:</span> <span class="string">javax.inject.Singleton</span></span><br><span class="line">      <span class="comment"># 連線逾時時間 (單位：毫秒)</span></span><br><span class="line">      <span class="attr">connect-timeout:</span> <span class="number">5000</span></span><br><span class="line">      <span class="comment"># 讀取逾時時間 (單位：毫秒)</span></span><br><span class="line">      <span class="attr">read-timeout:</span> <span class="number">10000</span></span><br><span class="line">  <span class="comment"># MongoDB 資料庫設定</span></span><br><span class="line">  <span class="attr">mongodb:</span></span><br><span class="line">      <span class="comment"># 資料庫連接字串</span></span><br><span class="line">      <span class="attr">connection-string:</span> <span class="string">&quot;mongodb://localhost:27017&quot;</span></span><br><span class="line">      <span class="comment"># 資料庫名稱</span></span><br><span class="line">      <span class="attr">database:</span> <span class="string">&quot;youbike_db&quot;</span></span><br><span class="line">  <span class="comment"># Redis 設定</span></span><br><span class="line">  <span class="attr">redis:</span></span><br><span class="line">      <span class="comment"># Redis 伺服器的主機名稱</span></span><br><span class="line">      <span class="attr">host:</span> <span class="string">&quot;redis://localhost:6379&quot;</span></span><br><span class="line">  <span class="attr">hibernate-orm:</span></span><br><span class="line">    <span class="comment"># 當設定為 drop-and-create 時，每次 Quarkus 啟動都會清除並重建資料庫結構。</span></span><br><span class="line">    <span class="comment"># 這在開發初期非常方便，但在生產環境中應改為 &#x27;validate&#x27; 或 &#x27;update&#x27;。</span></span><br><span class="line">    <span class="attr">database:</span></span><br><span class="line">      <span class="attr">generation:</span> <span class="string">drop-and-create</span></span><br><span class="line">    <span class="comment"># 在主控台顯示執行的 SQL 語句，方便開發時除錯</span></span><br><span class="line">    <span class="attr">log:</span></span><br><span class="line">      <span class="attr">sql:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">db-kind:</span> <span class="string">mysql</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">jay12345</span></span><br><span class="line">    <span class="attr">jdbc:</span></span><br><span class="line">      <span class="attr">url:</span> <span class="string">jdbc:mysql://localhost:9527/user_db?createDatabaseIfNotExist=true</span></span><br><span class="line">  <span class="comment"># OpenAPI / Swagger UI 設定</span></span><br><span class="line">  <span class="attr">smallrye-openapi:</span></span><br><span class="line">    <span class="attr">path:</span> <span class="string">/openapi</span></span><br><span class="line">  <span class="attr">swagger-ui:</span></span><br><span class="line">    <span class="attr">path:</span> <span class="string">/q/swagger-ui</span></span><br><span class="line">    <span class="attr">always-include:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># 日誌記錄相關設定</span></span><br><span class="line">  <span class="attr">log:</span></span><br><span class="line">    <span class="comment"># 全域預設的日誌記錄層級</span></span><br><span class="line">    <span class="attr">level:</span> <span class="string">INFO</span></span><br><span class="line">    <span class="comment"># 針對特定類別或套件設定日誌層級</span></span><br><span class="line">    <span class="attr">category:</span></span><br><span class="line">      <span class="comment"># 將 &#x27;org.jay&#x27; 套件下的日誌層級設定為 DEBUG</span></span><br><span class="line">      <span class="attr">&quot;org.jay&quot;:</span></span><br><span class="line">        <span class="attr">level:</span> <span class="string">DEBUG</span></span><br><span class="line">    <span class="comment"># 控制台日誌輸出設定</span></span><br><span class="line">    <span class="attr">console:</span></span><br><span class="line">      <span class="comment"># 設定日誌輸出的格式</span></span><br><span class="line">      <span class="comment"># %d&#123;yyyy-MM-dd HH:mm:ss,SSS&#125;: 日期與時間</span></span><br><span class="line">      <span class="comment"># %-5p: 日誌層級 (例如 INFO, DEBUG)</span></span><br><span class="line">      <span class="comment"># [%c&#123;1.&#125;]: 類別名稱 (簡寫)</span></span><br><span class="line">      <span class="comment"># (%t): 執行緒名稱</span></span><br><span class="line">      <span class="comment"># %s: 日誌訊息</span></span><br><span class="line">      <span class="comment"># %e: 例外堆疊追蹤</span></span><br><span class="line">      <span class="comment"># %n: 換行符</span></span><br><span class="line">      <span class="attr">format:</span> <span class="string">&quot;%d&#123;yyyy-MM-dd HH:mm:ss,SSS&#125; %-5p [%c&#123;1.&#125;] (%t) %s%e%n&quot;</span></span><br><span class="line"><span class="attr">mp:</span></span><br><span class="line">  <span class="attr">jwt:</span></span><br><span class="line">    <span class="attr">verify:</span></span><br><span class="line">      <span class="comment"># 簽發 JWT 的單位名稱，登入 API 產生的 token 中 &#x27;iss&#x27; 欄位會是這個值</span></span><br><span class="line">      <span class="attr">issuer:</span> <span class="string">https://myapp.com/issuer</span></span><br><span class="line">      <span class="comment"># 用於驗證 JWT 簽章的公鑰位置。Quarkus 會從 classpath 中尋找這個檔案。</span></span><br><span class="line">      <span class="attr">publickey:</span></span><br><span class="line">        <span class="attr">location:</span> <span class="string">META-INF/resources/publicKey.pem</span></span><br><span class="line"><span class="comment"># --- SmallRye JWT Configuration ---</span></span><br><span class="line"><span class="attr">smallrye:</span></span><br><span class="line">  <span class="attr">jwt:</span></span><br><span class="line">    <span class="attr">sign:</span></span><br><span class="line">      <span class="attr">key:</span></span><br><span class="line">        <span class="attr">location:</span> <span class="string">META-INF/resources/privateKey.pem</span></span><br><span class="line"><span class="comment"># 自訂的 JWT 產生設定</span></span><br><span class="line"><span class="attr">app:</span></span><br><span class="line">  <span class="attr">jwt:</span></span><br><span class="line">    <span class="attr">duration-in-seconds:</span> <span class="number">3600</span> <span class="comment"># Token 有效期 (秒)</span></span><br><span class="line"><span class="comment"># --- Test Profile ---</span></span><br><span class="line"><span class="comment"># 只有在執行測試時，以下的設定才會生效</span></span><br><span class="line"><span class="string">&quot;%test&quot;</span><span class="string">:</span></span><br><span class="line">  <span class="attr">quarkus:</span></span><br><span class="line">    <span class="comment"># 覆寫測試時的資料庫種類為 H2 (記憶體資料庫)</span></span><br><span class="line">    <span class="attr">datasource:</span></span><br><span class="line">      <span class="attr">db-kind:</span> <span class="string">h2</span></span><br><span class="line">      <span class="attr">jdbc:</span></span><br><span class="line">        <span class="comment"># H2 的記憶體模式連線 URL</span></span><br><span class="line">        <span class="attr">url:</span> <span class="string">jdbc:h2:mem:test_db;DB_CLOSE_DELAY=-1</span></span><br><span class="line">    <span class="comment"># 覆寫測試時的 Hibernate ORM 設定</span></span><br><span class="line">    <span class="attr">hibernate-orm:</span></span><br><span class="line">      <span class="attr">database:</span></span><br><span class="line">        <span class="comment"># 在測試時，每次都清空並重建資料庫結構</span></span><br><span class="line">        <span class="attr">generation:</span> <span class="string">drop-and-create</span></span><br></pre></td></tr></table></figure>

</details>

<h2 id="BOM"><a href="#BOM" class="headerlink" title="BOM"></a>BOM</h2><p>MySQL、JWT、OpenAPI 等等相關依賴</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- scheduler --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.quarkus<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>quarkus-scheduler<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- MySQL Driver --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.quarkus<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>quarkus-jdbc-mysql<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- Hibernate ORM with Panache --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.quarkus<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>quarkus-hibernate-orm-panache<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.quarkus<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>quarkus-hibernate-validator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- JWT Security --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.quarkus<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>quarkus-smallrye-jwt<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- Password Hashing --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.quarkus<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>quarkus-elytron-security-common<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- OpenAPI / Swagger UI --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.quarkus<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>quarkus-smallrye-openapi<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<details>

<summary>完整檔案</summary>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.jay<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>quarkus-training<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">compiler-plugin.version</span>&gt;</span>3.14.0<span class="tag">&lt;/<span class="name">compiler-plugin.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.release</span>&gt;</span>21<span class="tag">&lt;/<span class="name">maven.compiler.release</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.reporting.outputEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.reporting.outputEncoding</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">quarkus.platform.artifact-id</span>&gt;</span>quarkus-bom<span class="tag">&lt;/<span class="name">quarkus.platform.artifact-id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">quarkus.platform.group-id</span>&gt;</span>io.quarkus.platform<span class="tag">&lt;/<span class="name">quarkus.platform.group-id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">quarkus.platform.version</span>&gt;</span>3.23.0<span class="tag">&lt;/<span class="name">quarkus.platform.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">skipITs</span>&gt;</span>true<span class="tag">&lt;/<span class="name">skipITs</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">surefire-plugin.version</span>&gt;</span>3.5.2<span class="tag">&lt;/<span class="name">surefire-plugin.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>$&#123;quarkus.platform.group-id&#125;<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>$&#123;quarkus.platform.artifact-id&#125;<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;quarkus.platform.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">type</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">scope</span>&gt;</span>import<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.quarkus<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>quarkus-arc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.quarkus<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>quarkus-rest<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.quarkus<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>quarkus-rest-jackson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.quarkus<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>quarkus-rest-client-jackson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.quarkus<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>quarkus-config-yaml<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- MongoDB Client --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.quarkus<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>quarkus-mongodb-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.quarkus<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>quarkus-mongodb-panache<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Redis Client --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.quarkus<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>quarkus-redis-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.quarkus<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>quarkus-redis-cache<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Lombok --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.38<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- MapStruct --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mapstruct<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mapstruct<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.6.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- scheduler --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.quarkus<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>quarkus-scheduler<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- MySQL Driver --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.quarkus<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>quarkus-jdbc-mysql<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Hibernate ORM with Panache --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.quarkus<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>quarkus-hibernate-orm-panache<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.quarkus<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>quarkus-hibernate-validator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- JWT Security --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.quarkus<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>quarkus-smallrye-jwt<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Password Hashing --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.quarkus<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>quarkus-elytron-security-common<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- OpenAPI / Swagger UI --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.quarkus<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>quarkus-smallrye-openapi<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- Testing Dependencies --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.quarkus<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>quarkus-junit5<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.quarkus<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>quarkus-junit5-mockito<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.rest-assured<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>rest-assured<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.quarkus<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>quarkus-jdbc-h2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">sourceDirectory</span>&gt;</span>src/main/java<span class="tag">&lt;/<span class="name">sourceDirectory</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">testSourceDirectory</span>&gt;</span>src/test/java<span class="tag">&lt;/<span class="name">testSourceDirectory</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>$&#123;quarkus.platform.group-id&#125;<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>quarkus-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;quarkus.platform.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">extensions</span>&gt;</span>true<span class="tag">&lt;/<span class="name">extensions</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">goal</span>&gt;</span>build<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">goal</span>&gt;</span>generate-code<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">goal</span>&gt;</span>generate-code-tests<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-compiler-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;compiler-plugin.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">parameters</span>&gt;</span>true<span class="tag">&lt;/<span class="name">parameters</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">annotationProcessorPaths</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">path</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.38<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">path</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mapstruct<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mapstruct-processor<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.6.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">annotationProcessorPaths</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-surefire-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;surefire-plugin.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">systemPropertyVariables</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">java.util.logging.manager</span>&gt;</span>org.jboss.logmanager.LogManager<span class="tag">&lt;/<span class="name">java.util.logging.manager</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">maven.home</span>&gt;</span>$&#123;maven.home&#125;<span class="tag">&lt;/<span class="name">maven.home</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">systemPropertyVariables</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-failsafe-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;surefire-plugin.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">goal</span>&gt;</span>integration-test<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">goal</span>&gt;</span>verify<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">systemPropertyVariables</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">native.image.path</span>&gt;</span>$&#123;project.build.directory&#125;/$&#123;project.build.finalName&#125;-runner<span class="tag">&lt;/<span class="name">native.image.path</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">java.util.logging.manager</span>&gt;</span>org.jboss.logmanager.LogManager<span class="tag">&lt;/<span class="name">java.util.logging.manager</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">maven.home</span>&gt;</span>$&#123;maven.home&#125;<span class="tag">&lt;/<span class="name">maven.home</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">systemPropertyVariables</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">profiles</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">profile</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span>&gt;</span>native<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">activation</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">name</span>&gt;</span>native<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">activation</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">skipITs</span>&gt;</span>false<span class="tag">&lt;/<span class="name">skipITs</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">quarkus.native.enabled</span>&gt;</span>true<span class="tag">&lt;/<span class="name">quarkus.native.enabled</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">profile</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">profiles</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

</details>

<h2 id="User"><a href="#User" class="headerlink" title="User"></a>User</h2><p>在開始寫程式碼之前，我們需要先規劃好資料庫。</p>
<h3 id="User-Entity"><a href="#User-Entity" class="headerlink" title="User Entity"></a>User Entity</h3><p>users 資料表，其核心欄位如下：</p>
<ul>
<li>id (BIGINT, Primary Key, Auto Increment): 唯一識別碼。</li>
<li>account (VARCHAR, Unique): 使用者帳號，用於登入，不可重複。</li>
<li>password (VARCHAR): 用於儲存加密後的密碼。</li>
<li>email (VARCHAR, Unique): 使用者信箱，不可重複。</li>
<li>role (VARCHAR): 使用者角色，例如 ‘user’ 或 ‘admin’，用於權限控制。</li>
<li>created_time (DATETIME): 帳號建立時間。</li>
</ul>
<p>這個結構對應到專案中的 User.java 這個 Panache Entity。</p>
<details>

<summary>完整檔案</summary>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io.quarkus.elytron.security.common.BcryptUtil;</span><br><span class="line"><span class="keyword">import</span> io.quarkus.hibernate.orm.panache.PanacheEntity;</span><br><span class="line"><span class="keyword">import</span> jakarta.persistence.Column;</span><br><span class="line"><span class="keyword">import</span> jakarta.persistence.Entity;</span><br><span class="line"><span class="keyword">import</span> jakarta.persistence.PrePersist;</span><br><span class="line"><span class="keyword">import</span> jakarta.persistence.Table;</span><br><span class="line"><span class="keyword">import</span> lombok.Builder;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.EqualsAndHashCode;</span><br><span class="line"><span class="keyword">import</span> lombok.NoArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.experimental.Tolerate;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.time.Instant;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table(name = &quot;users&quot;)</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@EqualsAndHashCode(callSuper = true)</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span> <span class="comment">// Panache 需要一個無參數的建構子</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> <span class="keyword">extends</span> <span class="title class_">PanacheEntity</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Column(unique = true, nullable = false)</span></span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Column(nullable = false)</span></span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Column(unique = true, nullable = false)</span></span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Column(nullable = false)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="variable">isAdmin</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Instant createdTime;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// *** 這是關鍵：建立一個帶有 Builder 的客製化建構子 ***</span></span><br><span class="line">    <span class="meta">@Builder</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">(String username, String rawPassword, String email, <span class="type">boolean</span> isAdmin)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.username = username;</span><br><span class="line">        <span class="built_in">this</span>.password = BcryptUtil.bcryptHash(rawPassword); <span class="comment">// 在建構時就雜湊</span></span><br><span class="line">        <span class="built_in">this</span>.email = email;</span><br><span class="line">        <span class="built_in">this</span>.isAdmin = isAdmin;</span><br><span class="line">        <span class="built_in">this</span>.createdTime = Instant.now();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PrePersist</span> <span class="comment">// 在儲存到資料庫前執行</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">()</span> &#123;</span><br><span class="line">        createdTime = Instant.now();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 檢查提供的密碼是否與儲存的雜湊密碼相符</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">checkPassword</span><span class="params">(String rawPassword)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> BcryptUtil.matches(rawPassword, <span class="built_in">this</span>.password);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 將原始密碼轉換為 bcrypt 雜湊並儲存</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> rawPassword 原始密碼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setPassword</span><span class="params">(String rawPassword)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.password = BcryptUtil.bcryptHash(rawPassword);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</details>

<h2 id="User-UserRepository"><a href="#User-UserRepository" class="headerlink" title="User UserRepository"></a>User UserRepository</h2><p>你可能會疑問，為什麼 youbike 那邊沒有這個 Repository，這是因為 Quarkus 套件很全面，他可以做到讓你直接透過 Entity 操作 DB，但從架構面來說，應該要從 Repository 操作 DB，所以這邊用較正規的方式實作</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io.quarkus.hibernate.orm.panache.PanacheRepository;</span><br><span class="line"><span class="keyword">import</span> jakarta.enterprise.context.ApplicationScoped;</span><br><span class="line"><span class="keyword">import</span> org.jay.user.model.entity.User;</span><br><span class="line"></span><br><span class="line"><span class="meta">@ApplicationScoped</span> <span class="comment">// 讓這個 Repository 成為一個可被注入的 CDI Bean</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserRepository</span> <span class="keyword">implements</span> <span class="title class_">PanacheRepository</span>&lt;User&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">findByEmail</span><span class="params">(String email)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> find(<span class="string">&quot;email&quot;</span>, email).firstResult();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span>  User <span class="title function_">findByIsAdmin</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> find(<span class="string">&quot;isAdmin&quot;</span>, <span class="literal">true</span>).firstResult();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">add</span><span class="params">(String username, String rawPassword, String email, <span class="type">boolean</span> isAdmin)</span> &#123;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> User.builder()</span><br><span class="line">                .username(username)</span><br><span class="line">                .rawPassword(rawPassword)</span><br><span class="line">                .email(email)</span><br><span class="line">                .isAdmin(isAdmin)</span><br><span class="line">                .build();</span><br><span class="line">        persist(user); <span class="comment">// 使用 PanacheRepository 提供的 persist 方法</span></span><br><span class="line">        <span class="keyword">return</span> user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="一些-DTO"><a href="#一些-DTO" class="headerlink" title="一些 DTO"></a>一些 DTO</h2><p>搭配 jakarta validation 實作欄位的驗證，讓外部可以更專注在商業邏輯上</p>
<h3 id="LoginRequest"><a href="#LoginRequest" class="headerlink" title="LoginRequest"></a>LoginRequest</h3><p>這是登入的 Request</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> jakarta.validation.constraints.Email;</span><br><span class="line"><span class="keyword">import</span> jakarta.validation.constraints.NotBlank;</span><br><span class="line"><span class="keyword">import</span> jakarta.validation.constraints.Size;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoginRequest</span> &#123;</span><br><span class="line">    <span class="meta">@NotBlank(message = &quot;Email cannot be blank&quot;)</span></span><br><span class="line">    <span class="meta">@Email(message = &quot;Email should be valid&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String email;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotBlank(message = &quot;Password cannot be blank&quot;)</span></span><br><span class="line">    <span class="meta">@Size(min = 8, message = &quot;Password must be at least 8 characters long&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String password;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="RegisterRequest"><a href="#RegisterRequest" class="headerlink" title="RegisterRequest"></a>RegisterRequest</h3><p>這是註冊的 Request</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> jakarta.validation.constraints.Email;</span><br><span class="line"><span class="keyword">import</span> jakarta.validation.constraints.NotBlank;</span><br><span class="line"><span class="keyword">import</span> jakarta.validation.constraints.Size;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RegisterRequest</span> &#123;</span><br><span class="line">    <span class="meta">@NotBlank(message = &quot;Username cannot be blank&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String username;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotBlank(message = &quot;Password cannot be blank&quot;)</span></span><br><span class="line">    <span class="meta">@Size(min = 8, message = &quot;Password must be at least 8 characters long&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String password;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotBlank(message = &quot;Email cannot be blank&quot;)</span></span><br><span class="line">    <span class="meta">@Email(message = &quot;Email should be valid&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String email;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="UserUpdateRequest"><a href="#UserUpdateRequest" class="headerlink" title="UserUpdateRequest"></a>UserUpdateRequest</h3><p>更新使用者的 Request</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> jakarta.validation.constraints.Size;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserUpdateRequest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 沒有 @NotBlank，允許為 null</span></span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 如果提供了密碼，長度至少為 8</span></span><br><span class="line">    <span class="meta">@Size(min = 8, message = &quot;Password must be at least 8 characters long&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="TokenResponse"><a href="#TokenResponse" class="headerlink" title="TokenResponse"></a>TokenResponse</h3><p>回傳的 token 結構</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.NoArgsConstructor;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span> <span class="comment">// 方便建立實例</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TokenResponse</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String token;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="UserProfileResponse"><a href="#UserProfileResponse" class="headerlink" title="UserProfileResponse"></a>UserProfileResponse</h3><p>回傳的 User 結構</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.time.Instant;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserProfileResponse</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">    <span class="keyword">private</span> Instant createdTime;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Mapper"><a href="#Mapper" class="headerlink" title="Mapper"></a>Mapper</h2><p>轉換你的 Entity 跟 DTO，這個範例只需要 User 就好</p>
<h3 id="UserMapper"><a href="#UserMapper" class="headerlink" title="UserMapper"></a>UserMapper</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.jay.user.model.dto.UserProfileResponse;</span><br><span class="line"><span class="keyword">import</span> org.jay.user.model.entity.User;</span><br><span class="line"><span class="keyword">import</span> org.mapstruct.Mapper;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Mapper(componentModel = &quot;cdi&quot;)</span> <span class="comment">// 讓 Quarkus 可以注入</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserMapper</span> &#123;</span><br><span class="line">    UserProfileResponse <span class="title function_">toUserProfileResponse</span><span class="params">(User user)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Token"><a href="#Token" class="headerlink" title="Token"></a>Token</h2><p>這邊使用 JWT 來完成 Token 機制，一般來說會產生兩個 token，一個是讓你驗證身份用，一個讓你 refresh token 用的，另外還會有 token 黑名單機制，以免 token 被濫用等等，但我們這邊就簡單實作，只產生一個 token ，射後不理</p>
<h3 id="如何產生"><a href="#如何產生" class="headerlink" title="如何產生"></a>如何產生</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Jwt.issuer(issuer) <span class="comment">// 簽發者，需與 application.yml 中設定的 mp.jwt.verify.issuer 相同</span></span><br><span class="line">        .upn(user.getEmail()) <span class="comment">// User Principal Name，通常是使用者名稱或 email</span></span><br><span class="line">        .groups(roles) <span class="comment">// 使用者的角色群組</span></span><br><span class="line">        .expiresIn(durationInSeconds)</span><br><span class="line">        .sign();</span><br></pre></td></tr></table></figure>
<p>他會產生一個包含使用者資訊的 JWT，並用私鑰 (Private Key) 進行簽章，等要後面需要帶 token 的 API 被呼叫時，他就會使用對應的公鑰 (Public Key) 來驗證 JWT 的簽章是否有效、Token 是否過期與取得 token 內的資料</p>
<details>

<summary>完整檔案</summary>
    
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> io.smallrye.jwt.build.Jwt;</span><br><span class="line"><span class="keyword">import</span> jakarta.enterprise.context.ApplicationScoped;</span><br><span class="line"><span class="keyword">import</span> jakarta.inject.Inject;</span><br><span class="line"><span class="keyword">import</span> org.eclipse.microprofile.config.inject.ConfigProperty;</span><br><span class="line"><span class="keyword">import</span> org.jay.user.model.entity.User;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashSet;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"></span><br><span class="line"><span class="meta">@ApplicationScoped</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TokenService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    <span class="meta">@ConfigProperty(name = &quot;mp.jwt.verify.issuer&quot;)</span> <span class="comment">// 從 application.yaml 注入 issuer</span></span><br><span class="line">    String issuer;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    <span class="meta">@ConfigProperty(name = &quot;app.jwt.duration-in-seconds&quot;)</span> <span class="comment">// 注入自訂的過期時間</span></span><br><span class="line">    <span class="type">long</span> durationInSeconds;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根據使用者資訊產生一個 JWT</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> user 使用者實體物件</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 產生的 JWT 字串</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">generateToken</span><span class="params">(User user)</span> &#123;</span><br><span class="line">        Set&lt;String&gt; roles = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line">        roles.add(<span class="string">&quot;user&quot;</span>); <span class="comment">// 所有使用者都至少有 &#x27;user&#x27; 角色</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// *** 如果是管理者，額外加入 &#x27;admin&#x27; 角色 ***</span></span><br><span class="line">        <span class="keyword">if</span> (user.isAdmin()) &#123;</span><br><span class="line">            roles.add(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Jwt.issuer(issuer) <span class="comment">// 簽發者，需與 application.yml 中設定的 mp.jwt.verify.issuer 相同</span></span><br><span class="line">                .upn(user.getEmail()) <span class="comment">// User Principal Name，通常是使用者名稱或 email</span></span><br><span class="line">                .groups(roles) <span class="comment">// 使用者的角色群組</span></span><br><span class="line">                .expiresIn(durationInSeconds)</span><br><span class="line">                .sign();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br></pre></td></tr></table></figure>
</details>

<h2 id="UserService"><a href="#UserService" class="headerlink" title="UserService"></a>UserService</h2><p>此會員模組會核心的部分</p>
<h3 id="如何透過-token-驗證"><a href="#如何透過-token-驗證" class="headerlink" title="如何透過 token 驗證"></a>如何透過 token 驗證</h3><p>首先要驗證前，要先給人家 token，透過 TokenService 來產生 Token</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Inject</span></span><br><span class="line">TokenService tokenService;</span><br><span class="line">    </span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line"><span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="comment">// create user</span></span><br><span class="line"><span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> tokenService.generateToken(user);</span><br></pre></td></tr></table></figure>
<p>再來只需要在 API 上加 annotation 就可以做到 token 驗證(這部分下面再講)，接下來就可以透過 token 拿到當初產生時放進去的資料了</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Inject</span></span><br><span class="line">JsonWebToken jwt;</span><br><span class="line">    </span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">// 前面的 upn 放 email 進去，這邊 getName 就會是 email</span></span><br><span class="line"><span class="type">String</span> <span class="variable">currentUserEmail</span> <span class="operator">=</span> jwt.getName();</span><br><span class="line">        </span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">// 權限檢查</span></span><br><span class="line"><span class="type">boolean</span> <span class="variable">isAdmin</span> <span class="operator">=</span> jwt.getGroups().contains(<span class="string">&quot;admin&quot;</span>);</span><br></pre></td></tr></table></figure>
<details>

<summary>完整檔案</summary>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> jakarta.enterprise.context.ApplicationScoped;</span><br><span class="line"><span class="keyword">import</span> jakarta.inject.Inject;</span><br><span class="line"><span class="keyword">import</span> jakarta.transaction.Transactional;</span><br><span class="line"><span class="keyword">import</span> jakarta.ws.rs.ForbiddenException;</span><br><span class="line"><span class="keyword">import</span> jakarta.ws.rs.NotFoundException;</span><br><span class="line"><span class="keyword">import</span> org.eclipse.microprofile.jwt.JsonWebToken;</span><br><span class="line"><span class="keyword">import</span> org.jay.user.model.dto.*;</span><br><span class="line"><span class="keyword">import</span> org.jay.user.model.entity.User;</span><br><span class="line"><span class="keyword">import</span> org.jay.user.model.mapper.UserMapper;</span><br><span class="line"><span class="keyword">import</span> org.jay.user.repository.UserRepository;</span><br><span class="line"><span class="keyword">import</span> org.jboss.logging.Logger;</span><br><span class="line"></span><br><span class="line"><span class="meta">@ApplicationScoped</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Logger</span> <span class="variable">LOG</span> <span class="operator">=</span> Logger.getLogger(UserService.class.getName());</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    UserRepository userRepository;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    TokenService tokenService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    UserMapper userMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    JsonWebToken jwt; <span class="comment">// 注入已驗證的 JWT，用於權限檢查</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 註冊新使用者並回傳 Token</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request 註冊請求</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 包含 Token 的回應 DTO</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Transactional</span></span><br><span class="line">    <span class="keyword">public</span> TokenResponse <span class="title function_">register</span><span class="params">(RegisterRequest request)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (userRepository.findByEmail(request.email) != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;This user already exists&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userRepository.add(request.username, request.password, request.email, <span class="literal">false</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> tokenService.generateToken(user);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">TokenResponse</span>(token);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 使用者登入並回傳 Token</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request 登入請求</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 包含 Token 的回應 DTO</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> TokenResponse <span class="title function_">login</span><span class="params">(LoginRequest request)</span> &#123;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userRepository.findByEmail(request.email);</span><br><span class="line">        <span class="keyword">if</span> (user != <span class="literal">null</span> &amp;&amp; user.checkPassword(request.password)) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> tokenService.generateToken(user);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">TokenResponse</span>(token);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;Invalid username or password&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 獲取當前登入者的個人資料</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 使用者資料 DTO</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> UserProfileResponse <span class="title function_">getCurrentUser</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">email</span> <span class="operator">=</span> jwt.getName();</span><br><span class="line">        LOG.infof(<span class="string">&quot;Current user email: %s&quot;</span>, email);</span><br><span class="line">        <span class="keyword">if</span> (email == <span class="literal">null</span> || email.isBlank()) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ForbiddenException</span>(<span class="string">&quot;You must be logged in to view your profile.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userRepository.findByEmail(email);</span><br><span class="line">        <span class="keyword">return</span> userMapper.toUserProfileResponse(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 更新使用者資料</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id 要更新的使用者 ID</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request 更新請求</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 更新後的使用者資料 DTO</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Transactional</span></span><br><span class="line">    <span class="keyword">public</span> UserProfileResponse <span class="title function_">updateUser</span><span class="params">(Long id, UserUpdateRequest request)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">currentUserEmail</span> <span class="operator">=</span> jwt.getName();</span><br><span class="line">        <span class="keyword">if</span> (currentUserEmail == <span class="literal">null</span> || currentUserEmail.isBlank()) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ForbiddenException</span>(<span class="string">&quot;You must be logged in to update your profile.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">User</span> <span class="variable">userToUpdate</span> <span class="operator">=</span> userRepository.findById(id);</span><br><span class="line">        <span class="keyword">if</span> (userToUpdate == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">NotFoundException</span>(<span class="string">&quot;User not found&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 權限檢查</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">isAdmin</span> <span class="operator">=</span> jwt.getGroups().contains(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">isSelf</span> <span class="operator">=</span> currentUserEmail.equals(userToUpdate.getEmail());</span><br><span class="line">        <span class="keyword">if</span> (!isAdmin &amp;&amp; !isSelf) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ForbiddenException</span>(<span class="string">&quot;You can only update your own profile.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 執行更新</span></span><br><span class="line">        <span class="keyword">if</span> (request.getUsername() != <span class="literal">null</span> &amp;&amp; !request.getUsername().isBlank()) &#123;</span><br><span class="line">            userToUpdate.setUsername(request.getUsername());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (request.getPassword() != <span class="literal">null</span> &amp;&amp; !request.getPassword().isEmpty()) &#123;</span><br><span class="line">            userToUpdate.setPassword(request.getPassword());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        userRepository.persist(userToUpdate);</span><br><span class="line">        <span class="keyword">return</span> userMapper.toUserProfileResponse(userToUpdate);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 刪除使用者</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id 要刪除的使用者 ID</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Transactional</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteUser</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">currentUserEmail</span> <span class="operator">=</span> jwt.getName();</span><br><span class="line">        <span class="keyword">if</span> (currentUserEmail == <span class="literal">null</span> || currentUserEmail.isBlank()) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ForbiddenException</span>(<span class="string">&quot;You must be logged in to delete a profile.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">User</span> <span class="variable">userToDelete</span> <span class="operator">=</span> userRepository.findById(id);</span><br><span class="line">        <span class="keyword">if</span> (userToDelete == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">NotFoundException</span>(<span class="string">&quot;User not found&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 權限檢查</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">isAdmin</span> <span class="operator">=</span> jwt.getGroups().contains(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">isSelf</span> <span class="operator">=</span> currentUserEmail.equals(userToDelete.getEmail());</span><br><span class="line">        <span class="keyword">if</span> (!isAdmin &amp;&amp; !isSelf) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ForbiddenException</span>(<span class="string">&quot;You can only delete your own profile.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        userRepository.delete(userToDelete);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">    </span><br></pre></td></tr></table></figure>

</details>
    
<h2 id="UserResource"><a href="#UserResource" class="headerlink" title="UserResource"></a>UserResource</h2><p>定義 API</p>
<h3 id="annotation"><a href="#annotation" class="headerlink" title="annotation"></a>annotation</h3><p>透過 annotation 來實作是否需要 token 跟權限檢查</p>
<ul>
<li>@PermitAll<blockquote>
<p>功能：允許所有人存取。這個端點不需要任何驗證，無論使用者是否登入或持有有效的 JWT 都可以呼叫。<br>用途：非常適合用於公開的端點，例如 &#x2F;login (登入)、&#x2F;register (註冊) 或 &#x2F;health (健康檢查)。</p>
</blockquote>
</li>
<li>@RolesAllowed({“role1”, “role2”})<blockquote>
<p>功能：只允許持有特定角色的使用者存取。這是最常用於授權的注解。<br>用途：Quarkus 會檢查傳入的 JWT，解析其 groups 聲明 (claim)，如果 groups 中包含 “role1” 或 “role2”，則允許存取。</p>
</blockquote>
</li>
<li>@Authenticated<blockquote>
<p>功能：只要求使用者必須經過驗證，但不檢查其角色。<br>用途：只要使用者提供了一個有效的、未過期的 JWT，就可以存取該端點。這適用於所有登入用戶都能使用的功能，例如「修改個人資料」。</p>
</blockquote>
</li>
<li>@DenyAll<blockquote>
<p>功能：拒絕所有人存取。<br>用途：比較少用，通常用於暫時禁用某個 API，或是在父類別設定了寬鬆權限，但想在子類別的某個方法上明確禁止存取。</p>
</blockquote>
</li>
</ul>
<details>

<summary>完整檔案</summary>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> jakarta.annotation.security.PermitAll;</span><br><span class="line"><span class="keyword">import</span> jakarta.annotation.security.RolesAllowed;</span><br><span class="line"><span class="keyword">import</span> jakarta.inject.Inject;</span><br><span class="line"><span class="keyword">import</span> jakarta.validation.Valid;</span><br><span class="line"><span class="keyword">import</span> jakarta.ws.rs.*;</span><br><span class="line"><span class="keyword">import</span> jakarta.ws.rs.core.MediaType;</span><br><span class="line"><span class="keyword">import</span> jakarta.ws.rs.core.Response;</span><br><span class="line"><span class="keyword">import</span> org.jay.user.model.dto.*;</span><br><span class="line"><span class="keyword">import</span> org.jay.user.service.UserService;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Path(&quot;/api/users&quot;)</span></span><br><span class="line"><span class="meta">@Produces(MediaType.APPLICATION_JSON)</span></span><br><span class="line"><span class="meta">@Consumes(MediaType.APPLICATION_JSON)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserResource</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    UserService userService; <span class="comment">// 現在只注入 UserService</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@POST</span></span><br><span class="line">    <span class="meta">@Path(&quot;/register&quot;)</span></span><br><span class="line">    <span class="meta">@PermitAll</span></span><br><span class="line">    <span class="keyword">public</span> Response <span class="title function_">register</span><span class="params">(<span class="meta">@Valid</span> RegisterRequest request)</span> &#123;</span><br><span class="line">        <span class="type">TokenResponse</span> <span class="variable">tokenResponse</span> <span class="operator">=</span> userService.register(request);</span><br><span class="line">        <span class="comment">// 回傳 201 Created 並附上 token</span></span><br><span class="line">        <span class="keyword">return</span> Response.status(Response.Status.CREATED).entity(tokenResponse).build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@POST</span></span><br><span class="line">    <span class="meta">@Path(&quot;/login&quot;)</span></span><br><span class="line">    <span class="meta">@PermitAll</span></span><br><span class="line">    <span class="keyword">public</span> Response <span class="title function_">login</span><span class="params">(<span class="meta">@Valid</span> LoginRequest request)</span> &#123;</span><br><span class="line">        <span class="type">TokenResponse</span> <span class="variable">tokenResponse</span> <span class="operator">=</span> userService.login(request);</span><br><span class="line">        <span class="keyword">return</span> Response.ok(tokenResponse).build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GET</span></span><br><span class="line">    <span class="meta">@Path(&quot;/me&quot;)</span></span><br><span class="line">    <span class="meta">@RolesAllowed(&#123;&quot;user&quot;, &quot;admin&quot;&#125;)</span></span><br><span class="line">    <span class="keyword">public</span> Response <span class="title function_">getMe</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">UserProfileResponse</span> <span class="variable">responseDto</span> <span class="operator">=</span> userService.getCurrentUser();</span><br><span class="line">        <span class="keyword">return</span> Response.ok(responseDto).build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PUT</span></span><br><span class="line">    <span class="meta">@Path(&quot;/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="meta">@RolesAllowed(&#123;&quot;user&quot;, &quot;admin&quot;&#125;)</span></span><br><span class="line">    <span class="keyword">public</span> Response <span class="title function_">updateUser</span><span class="params">(<span class="meta">@PathParam(&quot;id&quot;)</span> Long id, <span class="meta">@Valid</span> UserUpdateRequest request)</span> &#123;</span><br><span class="line">        <span class="type">UserProfileResponse</span> <span class="variable">responseDto</span> <span class="operator">=</span> userService.updateUser(id, request);</span><br><span class="line">        <span class="keyword">return</span> Response.ok(responseDto).build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@DELETE</span></span><br><span class="line">    <span class="meta">@Path(&quot;/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="meta">@RolesAllowed(&#123;&quot;user&quot;, &quot;admin&quot;&#125;)</span></span><br><span class="line">    <span class="keyword">public</span> Response <span class="title function_">deleteUser</span><span class="params">(<span class="meta">@PathParam(&quot;id&quot;)</span> Long id)</span> &#123;</span><br><span class="line">        userService.deleteUser(id);</span><br><span class="line">        <span class="keyword">return</span> Response.noContent().build(); <span class="comment">// 204 No Content</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</details>

<blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/JumBoJay06/QuarkusTraining-main">程式碼</a></p>
</blockquote>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>作者： </strong>JumBoJay
  </li>
  <li class="post-copyright-link">
    <strong>文章連結：</strong>
    <a href="https://jumbojay06.github.io/2025/07/03/MySQL%EF%BC%88SQL%E8%B3%87%E6%96%99%E5%BA%AB%EF%BC%89CRUD-%E8%88%87-API%E9%A9%97%E8%AD%89%E4%B9%8B%E5%AF%A6%E4%BD%9C/" title="MySQL（SQL資料庫）CRUD 與 API驗證之實作">https://jumbojay06.github.io/2025/07/03/MySQL（SQL資料庫）CRUD-與-API驗證之實作/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版權聲明： </strong>本網誌所有文章除特別聲明外，均採用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 許可協議。轉載請註明出處！
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Quarkus/" rel="tag"># Quarkus</a>
              <a href="/tags/MySQL/" rel="tag"># MySQL</a>
              <a href="/tags/JWT/" rel="tag"># JWT</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2025/07/01/MySQL%EF%BC%88SQL%E8%B3%87%E6%96%99%E5%BA%AB%EF%BC%89CRUD-%E8%88%87-API%E9%A9%97%E8%AD%89/" rel="prev" title="MySQL（SQL資料庫）CRUD 與 API驗證">
      <i class="fa fa-chevron-left"></i> MySQL（SQL資料庫）CRUD 與 API驗證
    </a></div>
      <div class="post-nav-item">
    <a href="/2025/07/04/Kafka-%E8%A8%8A%E6%81%AF%E7%B3%BB%E7%B5%B1%E3%80%81%E6%95%B4%E5%90%88%E5%A4%9A%E7%A8%AE%E8%B3%87%E6%96%99%E4%BE%86%E6%BA%90/" rel="next" title="Kafka 訊息系統、整合多種資料來源">
      Kafka 訊息系統、整合多種資料來源 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    
  <div class="comments">
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
    </div>
  </div>
  

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目錄
        </li>
        <li class="sidebar-nav-overview">
          本站概要
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#MySQL%EF%BC%88SQL%E8%B3%87%E6%96%99%E5%BA%AB%EF%BC%89CRUD-%E8%88%87-API%E9%A9%97%E8%AD%89%E4%B9%8B%E5%AF%A6%E4%BD%9C"><span class="nav-number">1.</span> <span class="nav-text">MySQL（SQL資料庫）CRUD 與 API驗證之實作</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A8%AD%E5%AE%9A%E6%AA%94"><span class="nav-number">1.1.</span> <span class="nav-text">設定檔</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#MySQL"><span class="nav-number">1.1.1.</span> <span class="nav-text">MySQL</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#OpenAPI"><span class="nav-number">1.2.</span> <span class="nav-text">OpenAPI</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#JWT"><span class="nav-number">1.3.</span> <span class="nav-text">JWT</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%AC%E7%A7%81%E9%91%B0"><span class="nav-number">1.3.1.</span> <span class="nav-text">公私鑰</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A8%AD%E5%AE%9A%E9%BB%A8"><span class="nav-number">1.3.2.</span> <span class="nav-text">設定黨</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#BOM"><span class="nav-number">1.4.</span> <span class="nav-text">BOM</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#User"><span class="nav-number">1.5.</span> <span class="nav-text">User</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#User-Entity"><span class="nav-number">1.5.1.</span> <span class="nav-text">User Entity</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#User-UserRepository"><span class="nav-number">1.6.</span> <span class="nav-text">User UserRepository</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E4%BA%9B-DTO"><span class="nav-number">1.7.</span> <span class="nav-text">一些 DTO</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#LoginRequest"><span class="nav-number">1.7.1.</span> <span class="nav-text">LoginRequest</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RegisterRequest"><span class="nav-number">1.7.2.</span> <span class="nav-text">RegisterRequest</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#UserUpdateRequest"><span class="nav-number">1.7.3.</span> <span class="nav-text">UserUpdateRequest</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TokenResponse"><span class="nav-number">1.7.4.</span> <span class="nav-text">TokenResponse</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#UserProfileResponse"><span class="nav-number">1.7.5.</span> <span class="nav-text">UserProfileResponse</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Mapper"><span class="nav-number">1.8.</span> <span class="nav-text">Mapper</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#UserMapper"><span class="nav-number">1.8.1.</span> <span class="nav-text">UserMapper</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Token"><span class="nav-number">1.9.</span> <span class="nav-text">Token</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A6%82%E4%BD%95%E7%94%A2%E7%94%9F"><span class="nav-number">1.9.1.</span> <span class="nav-text">如何產生</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#UserService"><span class="nav-number">1.10.</span> <span class="nav-text">UserService</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A6%82%E4%BD%95%E9%80%8F%E9%81%8E-token-%E9%A9%97%E8%AD%89"><span class="nav-number">1.10.1.</span> <span class="nav-text">如何透過 token 驗證</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#UserResource"><span class="nav-number">1.11.</span> <span class="nav-text">UserResource</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#annotation"><span class="nav-number">1.11.1.</span> <span class="nav-text">annotation</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">JumBoJay</p>
  <div class="site-description" itemprop="description">程式與攝影的交集</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">23</span>
          <span class="site-state-item-name">文章</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">19</span>
        <span class="site-state-item-name">分類</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">24</span>
        <span class="site-state-item-name">標籤</span></a>
      </div>
  </nav>
</div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">JumBoJay</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 強力驅動
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

<script>
  function loadCount() {
    var d = document, s = d.createElement('script');
    s.src = 'https://https-jumbojay06-github-io.disqus.com/count.js';
    s.id = 'dsq-count-scr';
    (d.head || d.body).appendChild(s);
  }
  // defer loading until the whole page loading is completed
  window.addEventListener('load', loadCount, false);
</script>
<script>
  var disqus_config = function() {
    this.page.url = "https://jumbojay06.github.io/2025/07/03/MySQL%EF%BC%88SQL%E8%B3%87%E6%96%99%E5%BA%AB%EF%BC%89CRUD-%E8%88%87-API%E9%A9%97%E8%AD%89%E4%B9%8B%E5%AF%A6%E4%BD%9C/";
    this.page.identifier = "2025/07/03/MySQL（SQL資料庫）CRUD-與-API驗證之實作/";
    this.page.title = "MySQL（SQL資料庫）CRUD 與 API驗證之實作";
    };
  NexT.utils.loadComments(document.querySelector('#disqus_thread'), () => {
    if (window.DISQUS) {
      DISQUS.reset({
        reload: true,
        config: disqus_config
      });
    } else {
      var d = document, s = d.createElement('script');
      s.src = 'https://https-jumbojay06-github-io.disqus.com/embed.js';
      s.setAttribute('data-timestamp', '' + +new Date());
      (d.head || d.body).appendChild(s);
    }
  });
</script>

</body>
</html>
